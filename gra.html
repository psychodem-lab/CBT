<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wyzwania Umys≈Çu - Trening Psychologiczny</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4361ee; --bg: #f8f9fa; --text: #212529;
            --card: #ffffff; --success: #4cc9f0; --danger: #f72585;
            --warning: #ff9f1c; --radius: 16px;
        }
        body.dark-mode {
            --bg: #121212; --text: #e0e0e0; --card: #1e1e1e; --primary: #4cc9f0;
        }
        * { box-sizing: border-box; color: var(--text); }
        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            background: var(--bg); margin: 0; transition: 0.3s;
        }
        #app { max-width: 700px; margin: 0 auto; padding: 20px; }
        .card { background: var(--card); border-radius: var(--radius); padding: 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .progress-bar { height: 10px; background: #333; border-radius: 5px; margin: 10px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); transition: 0.5s; }

        .btn-choice { 
            width: 100%; padding: 14px; margin: 8px 0; border: 1px solid #444; 
            border-radius: 10px; background: var(--card); cursor: pointer; text-align: left;
            transition: 0.2s; font-size: 15px; display: block;
        }
        .btn-choice:hover { background: var(--primary); color: white; }
        
        .feedback { padding: 15px; border-radius: 10px; margin: 15px 0; font-weight: bold; display: none; }
        .correct { background: #1b4332 !important; color: #74c69d !important; border: 1px solid #2d6a4f; }
        .wrong { background: #431212 !important; color: #ff8787 !important; border: 1px solid #641212; }

        textarea { width: 100%; height: 120px; background: var(--card); color: var(--text); border-radius: 8px; padding: 10px; border: 1px solid #444; }
        .hidden { display: none; }
        
        .mini-game-box { text-align: center; padding: 20px; border: 2px dashed var(--primary); border-radius: 15px; margin-top: 20px; }
        .category-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }

        @media print {
            .no-print { display: none; }
            body { background: white; color: black !important; }
            * { color: black !important; }
            .card { box-shadow: none; border: 1px solid #ccc; }
        }
    </style>
</head>
<body>

<div id="app">
    <div class="header no-print">
        <div style="color: var(--text)">‚≠ê <span id="xp">0</span> XP | ‚ö° <span id="energy">100</span>%</div>
        <button onclick="document.body.classList.toggle('dark-mode')" style="background: var(--card); border: 1px solid #444; padding: 5px 10px; border-radius: 5px; cursor: pointer;">üåì Tryb</button>
    </div>
    <div class="progress-bar no-print"><div id="p-fill" class="progress-fill" style="width: 100%"></div></div>

    <div id="m-menu" class="card no-print">
        <h2>Twoje Wyzwania</h2>
        <div id="hero-list"></div>
        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #444;">
        <button class="btn-choice" style="text-align: center; background: var(--warning); color: black;" onclick="startMiniGame()">üß™ Laboratorium: Fakty vs My≈õli</button>
        <button class="btn-choice" style="text-align: center; background: var(--success); color: black;" onclick="printSummary()">üñ®Ô∏è Generuj Raport Treningowy</button>
    </div>

    <div id="m-game" class="card hidden no-print">
        <h3 id="g-title"></h3>
        <p id="g-text" style="font-size: 1.1em;"></p>
        <div id="g-choices"></div>
        <div id="g-feedback" class="feedback"></div>
        <button id="g-next" class="btn-choice hidden" style="background: var(--primary); color: white; text-align: center;" onclick="goReflection()">Dalej</button>
    </div>

    <div id="m-mini-game" class="card hidden no-print">
        <h3>üß™ Laboratorium Poznawcze</h3>
        <p>Zaklasyfikuj poni≈ºsze stwierdzenie do odpowiedniej kategorii:</p>
        <div class="mini-game-box">
            <h2 id="mg-statement">≈Åadujƒô...</h2>
        </div>
        <div class="category-grid">
            <button class="btn-choice" style="text-align:center" onclick="checkMG('Fakt')">Fakt</button>
            <button class="btn-choice" style="text-align:center" onclick="checkMG('My≈õl')">My≈õl</button>
            <button class="btn-choice" style="text-align:center" onclick="checkMG('Emocja')">Emocja</button>
            <button class="btn-choice" style="text-align:center" onclick="checkMG('Zachowanie')">Zachowanie</button>
        </div>
        <div id="mg-feedback" class="feedback"></div>
        <button id="mg-back" class="btn-choice hidden" style="background: var(--primary); color: white; text-align: center;" onclick="resetToMenu()">Wr√≥ƒá do menu</button>
    </div>

    <div id="m-reflect" class="card hidden no-print">
        <h3>Twoja Refleksja</h3>
        <p id="r-prompt"></p>
        <textarea id="r-input" placeholder="Wpisz swoje przemy≈õlenia..."></textarea>
        <button class="btn-choice" style="background: var(--success); color: black; text-align: center;" onclick="saveAndExit()">Zapisz i wr√≥ƒá</button>
    </div>

    <div id="m-summary" class="hidden">
        <h1 style="text-align: center;">Raport Treningu Umiejƒôtno≈õci Psychologicznych</h1>
        <div id="s-content"></div>
        <button class="btn-choice no-print" onclick="window.location.reload()">Wr√≥ƒá do menu</button>
    </div>
</div>

<script>
    const scenarios = [
        { id: 0, icon: 'üò§', title: 'Marek: Wy≈õmiewanie', text: 'Koledzy drwiƒÖ z Twojego hobby. Co m√≥wisz?', rQ: 'Jak czujesz siƒô, gdy bronisz swoich pasji?', 
          choices: [
            { t: '‚ÄûSami jeste≈õcie nudni, spadajcie!‚Äù', type: 'agresja', f: 'Agresja rodzi op√≥r.', xp: 5, en: -20 },
            { t: '(Milczysz i odchodzisz)', type: 'uleg≈Ço≈õƒá', f: 'Uleg≈Ço≈õƒá kumuluje z≈Ço≈õƒá.', xp: 2, en: -15 },
            { t: '‚ÄûLubiƒô szachy i to moja sprawa. Proszƒô, nie drwijcie z tego.‚Äù', type: 'asertywno≈õƒá', f: 'Wzorowa asertywno≈õƒá.', xp: 25, en: 0 },
            { t: '‚ÄûPrzynajmniej nie jestem taki s≈Çaby z matmy jak wy.‚Äù', type: 'pas-agresja', f: 'To tylko zaostrzy konflikt.', xp: 10, en: -10 },
            { t: '‚ÄûDobra, to faktycznie g≈Çupie.‚Äù', type: 'unikanie', f: 'Zdrada w≈Çasnych warto≈õci boli najbardziej.', xp: 0, en: -25 }
          ]},
        { id: 1, icon: 'üò∞', title: 'Ania: Lƒôk Spo≈Çeczny', text: 'Stoisz przed grupƒÖ i czujesz parali≈º.', rQ: 'Co najbardziej przera≈ºa Ciƒô w ocenie innych?',
          choices: [
            { t: 'Uciekam bez s≈Çowa.', type: 'uleg≈Ço≈õƒá', f: 'Unikanie wzmacnia lƒôk.', xp: 0, en: -30 },
            { t: 'M√≥wiƒô: ‚ÄûPotrzebujƒô chwili, stresujƒô siƒô‚Äù.', type: 'asertywno≈õƒá', f: 'Otwarto≈õƒá buduje autentyczno≈õƒá.', xp: 25, en: -5 },
            { t: 'Zaczynam m√≥wiƒá bardzo g≈Ço≈õno i agresywnie.', type: 'agresja', f: 'To maskowanie lƒôku si≈ÇƒÖ.', xp: 5, en: -40 },
            { t: 'Stosujƒô oddech 4-7-8 i zaczynam spokojnie.', type: 'asertywno≈õƒá', f: 'Technika regulacji dzia≈Ça.', xp: 30, en: 0 },
            { t: 'Zamykam oczy i liczƒô na cud.', type: 'unikanie', f: 'Bierna postawa nie pomaga.', xp: 10, en: -10 }
          ]},
        { id: 2, icon: 'üí¨', title: 'Kasia: Granice', text: 'Przyjaciel chce po≈ºyczyƒá pieniƒÖdze 5-ty raz.', rQ: 'Dlaczego odmawianie jest dla Ciebie wyzwaniem?',
          choices: [
            { t: '‚ÄûNie mam, id≈∫ do banku!‚Äù', type: 'agresja', f: 'Zbyt szorstko.', xp: 10, en: -5 },
            { t: '‚ÄûJasne, proszƒô (mimo ≈ºe sam potrzebujƒô).‚Äù', type: 'uleg≈Ço≈õƒá', f: 'Brak granic prowadzi do frustracji.', xp: 2, en: -30 },
            { t: '‚ÄûNie po≈ºyczƒô Ci, bo nie odda≈Çe≈õ poprzednich. Przykro mi.‚Äù', type: 'asertywno≈õƒá', f: 'Konsekwencja to podstawa.', xp: 25, en: 0 },
            { t: '‚ÄûZnowu? Jeste≈õ beznadziejny w finansach.‚Äù', type: 'pas-agresja', f: 'Atakujesz osobƒô, nie problem.', xp: 5, en: -15 },
            { t: '‚ÄûZobaczymy... mo≈ºe jutro.‚Äù', type: 'unikanie', f: 'Zwlekanie to te≈º brak decyzji.', xp: 5, en: -10 }
          ]},
        { id: 3, icon: 'üíº', title: 'Tomasz: Nadgodziny', text: 'Szef prosi o pracƒô w piƒÖtek wieczorem.', rQ: 'Czy boisz siƒô konsekwencji zawodowych za asertywno≈õƒá?',
          choices: [
            { t: '‚ÄûSam Pan sobie sied≈∫!‚Äù', type: 'agresja', f: 'Nieprofesjonalne.', xp: 5, en: -25 },
            { t: '‚ÄûDobrze, zostanƒô (p≈ÇaczƒÖc w duchu).‚Äù', type: 'uleg≈Ço≈õƒá', f: 'Wypalenie blisko.', xp: 5, en: -40 },
            { t: '‚ÄûDzi≈õ nie mogƒô. Mam plany, kt√≥rych nie zmieniƒô.‚Äù', type: 'asertywno≈õƒá', f: 'Czas wolny to ≈õwiƒôto≈õƒá.', xp: 25, en: 0 },
            { t: '‚ÄûSkoro inni wyszli, to ja te≈º muszƒô?‚Äù', type: 'pas-agresja', f: 'Marudzenie nie pomaga.', xp: 10, en: -15 },
            { t: 'Wy≈õlizgujƒô siƒô z biura po cichu.', type: 'unikanie', f: 'Tch√≥rzostwo buduje z≈ÇƒÖ opiniƒô.', xp: 15, en: -5 }
          ]},
        { id: 4, icon: 'üëÇ', title: 'Zofia: Empatia', text: 'Przyjaciel p≈Çacze po rozstaniu.', rQ: 'Czy umiesz s≈Çuchaƒá bez dawania z≈Çotych rad?',
          choices: [
            { t: '‚ÄûDaj spok√≥j, tego kwiatu jest p√≥≈Ç ≈õwiatu!‚Äù', type: 'agresja', f: 'To uniewa≈ºnienie emocji.', xp: 5, en: -20 },
            { t: 'Te≈º zaczynam histerycznie p≈Çakaƒá.', type: 'uleg≈Ço≈õƒá', f: 'Przejmujesz b√≥l, nie pomagasz.', xp: 2, en: -30 },
            { t: '‚ÄûJestem przy Tobie. Chcesz o tym pogadaƒá czy pomilczeƒá?‚Äù', type: 'asertywno≈õƒá', f: 'Idealne wsparcie.', xp: 30, en: 0 },
            { t: '‚ÄûZawsze wybierasz z≈Çych ludzi.‚Äù', type: 'pas-agresja', f: 'Dobiegasz le≈ºƒÖcego.', xp: 0, en: -15 },
            { t: 'M√≥wiƒô, ≈ºe muszƒô pilnie i≈õƒá do domu.', type: 'unikanie', f: 'Brak gotowo≈õci na trudne emocje.', xp: 5, en: -10 }
          ]},
        { id: 5, icon: 'üß†', title: 'Adam: Samoocena', text: 'Dosta≈Çe≈õ awans, ale czujesz, ≈ºe to pomy≈Çka.', rQ: 'Co m√≥wi Tw√≥j wewnƒôtrzny krytyk?',
          choices: [
            { t: '‚ÄûTo przez ich b≈ÇƒÖd, zaraz mnie wyrzucƒÖ.‚Äù', type: 'uleg≈Ço≈õƒá', f: 'To syndrom oszusta.', xp: 5, en: -25 },
            { t: 'Wypisujƒô swoje 3 sukcesy z ostatniego miesiƒÖca.', type: 'asertywno≈õƒá', f: 'Fakty pokonujƒÖ lƒôk.', xp: 25, en: 0 },
            { t: 'M√≥wiƒô wszystkim: ‚ÄûJestem najlepszy, wiedzia≈Çem to!‚Äù', type: 'agresja', f: 'Pycha maskuje niepewno≈õƒá.', xp: 10, en: -10 },
            { t: '‚ÄûZobaczymy jak d≈Çugo to potrwa...‚Äù', type: 'pas-agresja', f: 'Podkopujesz w≈ÇasnƒÖ rado≈õƒá.', xp: 5, en: -15 },
            { t: 'Nie idƒô na spotkanie powitalne.', type: 'unikanie', f: 'Uciekasz przed sukcesem.', xp: 0, en: -20 }
          ]},
        { id: 6, icon: 'üíî', title: 'Ewa: Konflikt', text: 'Partner zapomnia≈Ç o Twoich urodzinach.', rQ: 'Czy wolisz milczeƒá, czy wyja≈õniaƒá sytuacjƒô od razu?',
          choices: [
            { t: 'Robiƒô wielkƒÖ awanturƒô i rzucam talerzem.', type: 'agresja', f: 'Przemoc nie rozwiƒÖzuje problem√≥w.', xp: 0, en: -40 },
            { t: 'M√≥wiƒô: ‚ÄûNic siƒô nie sta≈Ço‚Äù, ale czujƒô ≈ºal.', type: 'uleg≈Ço≈õƒá', f: 'T≈Çumienie uczuƒá rodzi urazƒô.', xp: 5, en: -30 },
            { t: '‚ÄûJest mi bardzo przykro. To dla mnie wa≈ºny dzie≈Ñ.‚Äù', type: 'asertywno≈õƒá', f: 'Komunikat JA buduje blisko≈õƒá.', xp: 25, en: 0 },
            { t: 'Nie odzywam siƒô do niego przez tydzie≈Ñ.', type: 'pas-agresja', f: 'Ciche dni to bierna agresja.', xp: 5, en: -25 },
            { t: 'Udajƒô, ≈ºe ja te≈º zapomnia≈Çam.', type: 'unikanie', f: 'Gry psychologiczne sƒÖ mƒôczƒÖce.', xp: 10, en: -15 }
          ]},
        { id: 7, icon: '‚è≥', title: 'Jakub: Czas', text: 'Masz wa≈ºny termin, a siedzisz na telefonie.', rQ: 'Co Ciƒô rozprasza, gdy pojawia siƒô trudne zadanie?',
          choices: [
            { t: 'Wyrzucam telefon przez okno ze z≈Ço≈õci.', type: 'agresja', f: 'Zbyt gwa≈Çtownie.', xp: 5, en: -20 },
            { t: '‚ÄûJestem leniem i nic nie osiƒÖgnƒô.‚Äù', type: 'uleg≈Ço≈õƒá', f: 'Samobiczowanie parali≈ºuje.', xp: 0, en: -35 },
            { t: 'Ustawiam stoper na 10 minut i zaczynam ma≈Çy krok.', type: 'asertywno≈õƒá', f: 'Metoda ma≈Çych krok√≥w wygrywa.', xp: 25, en: 0 },
            { t: '‚ÄûInni te≈º nic nie robiƒÖ...‚Äù', type: 'pas-agresja', f: 'Por√≥wnywanie to pu≈Çapka.', xp: 5, en: -10 },
            { t: 'Idƒô spaƒá, ≈ºeby o tym nie my≈õleƒá.', type: 'unikanie', f: 'Prokrastynacja to lƒôk przed pora≈ºkƒÖ.', xp: 10, en: -15 }
          ]},
        { id: 8, icon: 'üì±', title: 'Lena: Hejt', text: 'Kto≈õ skrytykowa≈Ç Tw√≥j wyglƒÖd w sieci.', rQ: 'Czyja opinia o Tobie jest najwa≈ºniejsza?',
          choices: [
            { t: 'Piszƒô mu: ‚ÄûSam jeste≈õ brzydki!‚Äù', type: 'agresja', f: 'Zni≈ºasz siƒô do jego poziomu.', xp: 5, en: -30 },
            { t: 'Kasujƒô zdjƒôcie i p≈Çaczƒô.', type: 'uleg≈Ço≈õƒá', f: 'Dajesz hejterowi w≈Çadzƒô.', xp: 2, en: -25 },
            { t: 'Blokujƒô u≈ºytkownika i zapominam.', type: 'asertywno≈õƒá', f: 'Higiena cyfrowa to podstawa.', xp: 20, en: 0 },
            { t: '‚ÄûCiekawe co Ty masz w lustrze...‚Äù', type: 'pas-agresja', f: 'Wchodzisz w toksycznƒÖ grƒô.', xp: 5, en: -15 },
            { t: 'Pytam znajomych, czy to prawda.', type: 'unikanie', f: 'Szukasz potwierdzenia na zewnƒÖtrz.', xp: 10, en: -10 }
          ]},
        { id: 9, icon: 'üéØ', title: 'Piotr: Perfekcja', text: 'Projekt jest gotowy, ale chcesz go poprawiƒá 10-ty raz.', rQ: 'Czy umiesz odpu≈õciƒá, gdy co≈õ jest ‚ÄûwystarczajƒÖco dobre‚Äù?',
          choices: [
            { t: 'Zarywam noc, ≈ºeby dopie≈õciƒá detale.', type: 'uleg≈Ço≈õƒá', f: 'Kosztem zdrowia? Nie warto.', xp: 5, en: -40 },
            { t: 'Wysy≈Çam tak jak jest, akceptujƒÖc niedoskona≈Ço≈õƒá.', type: 'asertywno≈õƒá', f: 'Done is better than perfect.', xp: 30, en: 10 },
            { t: 'Krzyczƒô na wsp√≥≈Çpracownika, ≈ºe on nic nie poprawi≈Ç.', type: 'agresja', f: 'Przerzucasz w≈Çasny stres na innych.', xp: 5, en: -20 },
            { t: '‚ÄûZawsze muszƒô robiƒá wszystko sam...‚Äù', type: 'pas-agresja', f: 'Mƒôcze≈Ñstwo nie pomaga.', xp: 5, en: -15 },
            { t: 'Zostawiam projekt i nie oddajƒô go w og√≥le.', type: 'unikanie', f: 'Sabotujesz w≈ÇasnƒÖ pracƒô.', xp: 0, en: -30 }
          ]}
    ];

    const miniGameData = [
        { s: "Czujƒô ucisk w klatce piersiowej.", c: "Fakt" },
        { s: "Na pewno mnie nie lubiƒÖ.", c: "My≈õl" },
        { s: "Czujƒô smutek.", c: "Emocja" },
        { s: "Wyszed≈Çem z pokoju bez s≈Çowa.", c: "Zachowanie" },
        { s: "Moje tƒôtno wynosi 100 uderze≈Ñ na minutƒô.", c: "Fakt" },
        { s: "Jestem beznadziejny.", c: "My≈õl" },
        { s: "Czujƒô lƒôk.", c: "Emocja" },
        { s: "ZacisnƒÖ≈Çem piƒô≈õci.", c: "Zachowanie" }
    ];

    let state = { xp: 0, energy: 100, current: null, results: [], mgIndex: 0 };

    function init() {
        const list = document.getElementById('hero-list');
        list.innerHTML = '';
        scenarios.forEach(s => {
            list.innerHTML += `<button class="btn-choice" onclick="start(${s.id})">${s.icon} ${s.title}</button>`;
        });
    }

    function start(id) {
        state.current = scenarios[id];
        document.getElementById('m-menu').classList.add('hidden');
        document.getElementById('m-game').classList.remove('hidden');
        document.getElementById('g-title').innerText = state.current.title;
        document.getElementById('g-text').innerText = state.current.text;
        
        const cDiv = document.getElementById('g-choices');
        cDiv.innerHTML = '';
        state.current.choices.forEach((c, idx) => {
            cDiv.innerHTML += `<button class="btn-choice" onclick="select(${idx})">${c.t}</button>`;
        });
    }

    function select(idx) {
        const c = state.current.choices[idx];
        state.xp += c.xp;
        state.energy = Math.max(0, state.energy + c.en);
        document.getElementById('xp').innerText = state.xp;
        document.getElementById('energy').innerText = state.energy;
        document.getElementById('p-fill').style.width = state.energy + '%';

        const fb = document.getElementById('g-feedback');
        fb.innerText = c.f;
        fb.className = `feedback show ${c.type === 'asertywno≈õƒá' ? 'correct' : 'wrong'}`;
        fb.style.display = 'block';
        document.getElementById('g-next').classList.remove('hidden');
    }

    function goReflection() {
        document.getElementById('m-game').classList.add('hidden');
        document.getElementById('m-reflect').classList.remove('hidden');
        document.getElementById('r-prompt').innerText = state.current.rQ;
    }

    function saveAndExit() {
        const reflection = document.getElementById('r-input').value;
        state.results.push({ title: state.current.title, reflection: reflection });
        resetToMenu();
    }

    function resetToMenu() {
        document.getElementById('r-input').value = '';
        document.getElementById('g-next').classList.add('hidden');
        document.getElementById('g-feedback').style.display = 'none';
        document.getElementById('m-reflect').classList.add('hidden');
        document.getElementById('m-game').classList.add('hidden');
        document.getElementById('m-mini-game').classList.add('hidden');
        document.getElementById('m-menu').classList.remove('hidden');
    }

    function startMiniGame() {
        state.mgIndex = 0;
        document.getElementById('m-menu').classList.add('hidden');
        document.getElementById('m-mini-game').classList.remove('hidden');
        document.getElementById('mg-back').classList.add('hidden');
        renderMG();
    }

    function renderMG() {
        if(state.mgIndex >= miniGameData.length) {
            document.getElementById('mg-statement').innerText = "Brawo! Uko≈Ñczono laboratorium.";
            document.getElementById('mg-back').classList.remove('hidden');
            return;
        }
        document.getElementById('mg-statement').innerText = miniGameData[state.mgIndex].s;
        document.getElementById('mg-feedback').style.display = 'none';
    }

    function checkMG(category) {
        const correct = miniGameData[state.mgIndex].c;
        const fb = document.getElementById('mg-feedback');
        fb.style.display = 'block';
        
        if(category === correct) {
            fb.innerText = "Poprawnie! +10 XP";
            fb.className = "feedback correct";
            state.xp += 10;
        } else {
            fb.innerText = `To b≈ÇƒÖd. Poprawna kategoria to: ${correct}`;
            fb.className = "feedback wrong";
        }
        document.getElementById('xp').innerText = state.xp;
        
        setTimeout(() => {
            state.mgIndex++;
            renderMG();
        }, 1500);
    }

    function printSummary() {
        document.getElementById('m-menu').classList.add('hidden');
        document.getElementById('m-summary').classList.remove('hidden');
        const content = document.getElementById('s-content');
        content.innerHTML = state.results.map(r => `
            <div class="card">
                <h3>${r.title}</h3>
                <p><strong>Refleksja:</strong> ${r.reflection || 'Brak wpisu'}</p>
            </div>
        `).join('') || '<p>Uko≈Ñcz zadania, aby wygenerowaƒá raport.</p>';
        window.print();
    }

    init();
</script>
</body>
</html>
